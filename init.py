import sys
import os
from random import choice

public = [(10095259, 2), (61606711, 2), (50076493, 2), (62699137, 2), (41711951, 2),
          (65843671, 2), (20314373, 2), (40904453, 2), (96249133, 2), (92746471, 2), 
          (76261139, 2), (20930387, 2), (21799397, 2), (75834469, 2), (76307113, 5), 
          (10932697, 7), (20512243, 2), (81246463, 2), (20435021, 2), (60413371, 2), 
          (41778829, 2), (10994899, 2), (40214453, 2), (10198337, 2), (91791593, 2), 
          (62914751, 7), (87879587, 2), (43719727, 2), (63048899, 2), (41727547, 2), 
          (40936981, 2), (83375767, 2), (86965721, 2), (86055271, 2), (30870349, 2), 
          (10633621, 2), (10386347, 2), (53817877, 2), (10972421, 2), (97285219, 2), 
          (84530489, 2), (20187259, 2), (98552989, 2), (10305839, 11), (52311629, 2), 
          (30047753, 3), (53743981, 2), (86118103, 2), (84713021, 2), (20073419, 2), 
          (95515967, 2), (96985573, 2), (10951747, 2), (51458569, 2), (74726053, 2), 
          (82230541, 2), (65012081, 2), (51482699, 2), (65678189, 2), (10997081, 2), 
          (10212313, 5), (54928171, 2), (75189041, 2), (43482091, 2), (96930599, 2), 
          (10379671, 22), (97625887, 2), (30995521, 11), (65717203, 2), (63888191, 2), 
          (92593343, 2), (31428307, 2), (90969103, 2), (54885443, 2), (54557467, 2), 
          (97722593, 2), (63875311, 2), (41458679, 2), (82900967, 2), (53712569, 6), 
          (70662899, 2), (62109037, 2), (65585173, 2), (42257627, 2), (71957357, 2), 
          (32674907, 2), (21739603, 2), (76470959, 2), (10104539, 2), (64692689, 2), 
          (31109459, 2), (93474463, 2), (10734883, 2), (52096001, 7), (21213089, 2), 
          (51831277, 2), (97424953, 2), (65753953, 7), (84266981, 2), (75968003, 5)]

if __name__ == "__main__":
    if len(sys.argv) > 2 or len(sys.argv) < 2:
        print("Usage:\tinit <filename>")
        exit(62)
    else:
        p, a = choice(public)
        default_key = "".join([choice("0123456789") for i in range(32)])
        
        filepath = sys.argv[1].split("/")
        bank_filename = filepath[-1] + ".bank"
        atm_filename = filepath[-1] + ".atm"
        filepath = "/".join(filepath[:-1]) + "/"

        if not os.path.exists(filepath):
            os.makedirs(filepath)

        if os.path.isfile(filepath+bank_filename) or os.path.isfile(filepath+atm_filename):
            print("Error:\tone of the files already exists")
            exit(63)

        with open(filepath+bank_filename, "w") as f:
            f.write(str(p))
            f.write("\n")
            f.write(str(a))
            f.write("\n")
            f.write(default_key)

        with open(filepath+atm_filename, "w") as f:
            f.write(str(p))
            f.write("\n")
            f.write(str(a))
            f.write("\n")
            f.write(default_key)

        print("Successfully initialized bank state")
        exit(0)
